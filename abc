<main>
  <div class="upload">
    <pre>File Upload</pre>
    <div class="box">
      <div class="file">
        <p>Source A</p>
        <label class="upload-label">
          <input type="file" class="upload-input" (change)="onFileUpload($event, 1)" />
          <span class="upload-placeholder">
            <span class="pi pi-file-excel"></span>
            <span *ngIf="filename1" class="upload-filename">{{ filename1 }}</span>
          </span>
        </label>
      </div>

      <div class="file">
        <p>Source B</p>
        <label class="upload-label">
          <input type="file" class="upload-input" (change)="onFileUpload($event, 2)" />
          <span class="upload-placeholder">
            <span class="pi pi-file-excel"></span>
            <span *ngIf="filename2" class="upload-filename">{{ filename2 }}</span>
          </span>
        </label>
      </div>
    </div>

    <div class="box drag-drop-box">
      <p>Drag and drop columns to match</p>
      <div class="columns-container">
        <div class="source-box" (dragover)="onDragOver($event)" (drop)="onDrop($event, 'A')">
          <h5>Source A Columns</h5>
          <div
            *ngFor="let col of file1Columns"
            draggable="true"
            (dragstart)="onDragStart($event, col, 'A')"
            class="draggable-item"
          >
            {{ col }}
          </div>
        </div>

        <div class="target-box" (dragover)="onDragOver($event)" (drop)="onDrop($event, 'B')">
          <h5>Source B Columns</h5>
          <div
            *ngFor="let col of file2Columns"
            draggable="true"
            (dragstart)="onDragStart($event, col, 'B')"
            class="draggable-item"
          >
            {{ col }}
          </div>
        </div>
      </div>

      <div class="matched-columns" *ngIf="selectedCol1 && selectedCol2">
        <p>Matched Column:</p>
        <p><strong>{{ selectedCol1 }}</strong> â†’ <strong>{{ selectedCol2 }}</strong></p>
      </div>
    </div>

    <button (click)="compareColumns()">Compare</button>
  </div>

  <div *ngIf="showTables" class="table-container">
    <div class="table-box">
      <h3>Source A</h3>
      <table>
        <thead>
          <tr>
            <th *ngFor="let col of file1Columns">{{ col }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of file1Data">
            <td *ngFor="let col of file1Columns">{{ row[col] }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="table-box">
      <h3>Source B</h3>
      <table>
        <thead>
          <tr>
            <th *ngFor="let col of file2Columns">{{ col }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of file2Data">
            <td *ngFor="let col of file2Columns">{{ row[col] }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="counts" *ngIf="showTables">
    <h4>Matched Rows: {{ matchedRows }}</h4>
    <h4>Unmatched Rows: {{ unmatchedRows }}</h4>
  </div>
</main>