Thanks for the clarification and the uploads.

✅ Based on your screenshots and the requirement:

You want to preserve the current dropdowns, edit functionality, and form logic.

You only want to add a popup (MatDialog) for the Add/Edit form — using your existing form and logic.

The table and UI code outside the popup should stay unchanged.



---

✅ Minimal Steps to Add Popup Without Changing Functionality:

1. Move Form to Template Reference for Dialog

Update your exchange-rates.component.html by wrapping the existing form in an ng-template:

<ng-template #popupTemplate>
  <form [formGroup]="form" (ngSubmit)="saveRate()">
    <label>From Currency:</label>
    <select formControlName="fromCurr" [attr.disabled]="editingId != null ? true : null">
      <option *ngFor="let curr of currencies" [value]="curr">{{ curr }}</option>
    </select>

    <label>To Currency:</label>
    <select formControlName="toCurr" [attr.disabled]="editingId != null ? true : null">
      <option *ngFor="let curr of currencies" [value]="curr">{{ curr }}</option>
    </select>

    <label>Rate:</label>
    <input formControlName="rate" placeholder="Rate" type="number" />

    <label>Last Modified:</label>
    <input formControlName="lastMod" type="date" placeholder="YYYY-MM-DD" [attr.disabled]="editingId != null ? true : null"/>

    <button type="submit">{{ editingId ? 'Update' : 'Add' }}</button>
    <button type="button" (click)="cancelEdit()">Cancel</button>
  </form>
</ng-template>

2. Add openPopup() Method in .ts

In your exchange-rates.component.ts, use this method to open the popup:

@ViewChild('popupTemplate') popupTemplate!: TemplateRef<any>;

openPopup(): void {
  this.editingId = null;
  this.form.reset();
  this.dialog.open(this.popupTemplate);
}

For Edit:

editRate(rate: any): void {
  this.editingId = rate.id;
  this.form.setValue({
    fromCurr: rate.fromCurr,
    toCurr: rate.toCurr,
    rate: rate.rate,
    lastMod: rate.lastMod
  });
  this.dialog.open(this.popupTemplate);
}

3. Keep Your Existing Table UI as Is

Make sure the existing <table> and data loading logic is untouched.


---

This approach ensures:

✅ Your dropdowns remain intact.

✅ Editing logic is reused.

✅ Popup opens both on Add and Edit without changing core functionality.


Let me know if you want this integrated into the files you uploaded—I can generate the updated code for you directly.

