import { Component } from '@angular/core';
import { HttpClient, HttpParams } from '@angular/common/http';

@Component({
  selector: 'app-discrepancy-review',
  templateUrl: './discrepancy-review.component.html',
  styleUrls: ['./discrepancy-review.component.css']
})
export class DiscrepancyReviewComponent {
  foFile!: File;
  boFile!: File;
  foColumns: string[] = [];
  boColumns: string[] = [];
  selectedFOColumn = '';
  selectedBOColumn = '';
  discrepancies: string[] = [];

  constructor(private http: HttpClient) {}

  onFOFileSelected(event: any) {
    this.foFile = event.target.files[0];
    this.extractColumns(this.foFile, 'fo');
  }

  onBOFileSelected(event: any) {
    this.boFile = event.target.files[0];
    this.extractColumns(this.boFile, 'bo');
  }

  extractColumns(file: File, type: 'fo' | 'bo') {
    const reader = new FileReader();
    reader.onload = () => {
      const text = reader.result as string;
      const lines = text.split('\n');
      const headers = lines[0].split(',').map(h => h.trim());
      if (type === 'fo') this.foColumns = headers;
      else this.boColumns = headers;
    };
    reader.readAsText(file);
  }

  checkDiscrepancies() {
    if (!this.foFile || !this.boFile || !this.selectedFOColumn || !this.selectedBOColumn) return;

    const formData = new FormData();
    formData.append('file1', this.foFile);
    formData.append('file2', this.boFile);
    formData.append('column1', this.selectedFOColumn);
    formData.append('column2', this.selectedBOColumn);

    this.http.post<string[]>('http://localhost:8080/api/discrepancy/compare', formData)
      .subscribe(data => {
        this.discrepancies = data;
      });
  }
}






<div class="container">
  <div class="header">
    <img src="assets/bnp-logo.png" alt="BNP Logo" class="logo" />
    <h1>Discrepancy Review</h1>
  </div>

  <div class="form-group">
    <label>Upload FO File</label>
    <input type="file" (change)="onFOFileSelected($event)" />
  </div>

  <div class="form-group">
    <label>Upload BO File</label>
    <input type="file" (change)="onBOFileSelected($event)" />
  </div>

  <div class="form-group">
    <label>Select FO Column</label>
    <select [(ngModel)]="selectedFOColumn">
      <option *ngFor="let col of foColumns" [value]="col">{{ col }}</option>
    </select>
  </div>

  <div class="form-group">
    <label>Select BO Column</label>
    <select [(ngModel)]="selectedBOColumn">
      <option *ngFor="let col of boColumns" [value]="col">{{ col }}</option>
    </select>
  </div>

  <button (click)="checkDiscrepancies()">Check Discrepancies</button>

  <div *ngIf="discrepancies.length > 0">
    <h2>Discrepancies</h2>
    <ul>
      <li *ngFor="let d of discrepancies">{{ d }}</li>
    </ul>
  </div>
</div>






.container {
  max-width: 600px;
  margin: auto;
  padding: 20px;
  text-align: center;
}

.header {
  background-color: #2ecc71;
  color: white;
  padding: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.logo {
  width: 40px;
  margin-right: 10px;
}

.form-group {
  margin: 20px 0;
}

input[type="file"], select {
  width: 100%;
  padding: 5px;
  margin-top: 5px;
}

button {
  background-color: #2ecc71;
  color: white;
  padding: 10px 20px;
  border: none;
  cursor: pointer;
}

button:hover {
  background-color: #27ae60;
}